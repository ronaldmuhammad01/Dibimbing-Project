---
title: "Dibimbing Final Project"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Loan default can be defined as the inability of a borrower to fulfill his or her loan obligation as at when due
Default loans cost a lot on a bank on the way of its progress. It- Diminishes Asset Quality, Increases the Cost of Funds, Decreases the Profitability of the Bank, Decreases the Overall Credit Rating of the Bank

# R Packages
I have used below list of R packages in this project
```{r}
library(DT)          # For Data Tables
library(lattice)     # The lattice add-on of Trellis graphics for R
library(knitr)       # For Dynamic Report Generation in R 
library(gplots)      # Various R Programming Tools for Plotting Data
library(ggplot2)     # An Implementation of the Grammar of Graphics 
library(ClustOfVar)  # Clustering of variables 
library(ape)         # Analyses of Phylogenetics and Evolution (as.phylo) 
library(Information) # Data Exploration with Information Theory (Weight-of-Evidence and Information Value)
library(ROCR)        # Model Performance and ROC curve
library(caret)       # Classification and Regression Training -  for any machine learning algorithms
library(rpart)       # Recursive partitioning for classification, regression and survival trees
library(rpart.utils) # Tools for parsing and manipulating rpart objects, including generating machine readable rules
library(rpart.plot)  # Plot 'rpart' Models: An Enhanced Version of 'plot.rpart'
library(randomForest)# Leo Breiman and Cutler's Random Forests for Classification and Regression 
library(party)       # A computational toolbox for recursive partitioning - Conditional inference Trees
library(bnlearn)     # Bayesian Network Structure Learning, Parameter Learning and Inference
library(DAAG)        # Data Analysis and Graphics Data and Functions
library(vcd)         # Visualizing Categorical Data
library(kernlab)     # Support Vector Machine
library(ROSE)        # Sampling Analysis
library(dplyr)       # EDA
library(tidyverse)   # EDA
```


# Import Data Set
```{r}
Credit_Scoring <- read.csv("C:/Users/Ronald Muhammad/Downloads/credit scoring train.csv")
```

# Get first hand feeling of the data
```{r}
#Check Colnames
kable (as.data.frame (colnames(Credit_Scoring)))
```

```{r}
#Understand the strucutre of data
str(Credit_Scoring)

#Summary of the variable
summary(Credit_Scoring)

## Column x seems similar with the number indexing, so we should take out this column
Credit_Scoring <- subset(Credit_Scoring, select = -X)

#checking the data
DT::datatable(Credit_Scoring[1:100,])
head(Credit_Scoring)

#checking the missing value, the result shows no missing value found in this data set
colSums(is.na(Credit_Scoring))

#Change type of variable
Credit_Scoring$jumlah_kartu <- as.factor(Credit_Scoring$jumlah_kartu)
Credit_Scoring$outstanding <- as.numeric(Credit_Scoring$outstanding)
Credit_Scoring$kode_cabang <- as.factor(Credit_Scoring$kode_cabang)
Credit_Scoring$skor_delikuensi <- as.factor(Credit_Scoring$skor_delikuensi)
Credit_Scoring$flag_kredit_macet <- as.factor(Credit_Scoring$flag_kredit_macet)

```

#Data Analysis & Variable Creation
## Analysis of our response / target variable where 1 is default and 0 is not default
```{r}
Credit_Scoring$flag_kredit_macet <- as.factor(ifelse (Credit_Scoring$flag_kredit_macet == 0, "Good", "Default")) 

unique(Credit_Scoring$flag_kredit_macet)

Credit_Scoring %>%
  group_by(flag_kredit_macet) %>%
  summarise(percent = 100 * n () / nrow(Credit_Scoring))

op<-par(mfrow=c(1,2), new=TRUE)
plot(as.numeric(Credit_Scoring$flag_kredit_macet), ylab="Good-Bad", xlab="n", main="Good ~ Bad")
hist(as.numeric(Credit_Scoring$flag_kredit_macet), breaks=2, 
     xlab="Good(1) and Bad(2)", col="blue")

table(Credit_Scoring$flag_kredit_macet)
prop.table(table(Credit_Scoring$flag_kredit_macet))
```












